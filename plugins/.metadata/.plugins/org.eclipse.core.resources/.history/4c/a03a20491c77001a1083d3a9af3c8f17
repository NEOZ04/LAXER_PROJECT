<?php 

namespace laxer\phone;

use pocketmine\Player;
use laxer\ui\CoreUI;
use laxer\player\ProfileUI;
use laxer\guild\GuildUI;
use laxer\pshop\PShopUI;

class PhoneUI {
    
    private function getApps(Player $p = null){
        $apps = [
            ['Profile', new ProfileUI()],
            ['Friends', null],
            ['Guild', new GuildUI()],
        ];
        
        if ($p->hasPermission('laxer.guild.create')){
            $apps[] = ['PShop', new PShopUI()];
        }
        
        if ($p->hasPermission('laxer.pshop')){
            $apps[] = ['PShop', new PShopUI()];
        }
        return $apps;
    }
    
    public function getMainForm(Player $p){
        $ui = CoreUI::Simple(function (Player $p, $data){
            if ($data === null) return false;
            if (isset($this->getApps()[$data])) {
                $app = $this->getApps()[$data][1];
                $app->getMainForm($p);
                return true;
            }
        });
        $ui->setTitle(CoreUI::fTitle('MENU'));
        if (empty($this->getApps())) {
            $ui->addButton(CoreUI::fBButton('CLOSE'));
        }else {
            foreach ($this->getApps() as $app){
                $ui->addButton(CoreUI::fButton($app[0]));
            }
        }
        $ui->sendToPlayer($p);
    }
    
}